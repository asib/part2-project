clear;
ts = 1000*[0.267185287 0.267379108 0.267948412 0.26861993 0.267293262 0.267049994 0.268721477 0.267816495 0.266691055 0.267887157 0.266399084 0.26824182 0.267615024 0.267063571 0.266400911 0.266320089 0.26983958 0.265360256 0.265474301 0.268627591 0.268093153 0.266629066 0.267246954 0.270471955 0.268064591 0.266411562 0.267566556 0.26811483 0.266826683 0.267436954 0.267743991 0.268302858 0.266282244 0.267735572 0.272305528 0.265819266 0.267887083 0.267848722 0.266237761 0.269106523 0.267552775 0.289762313 0.265925737 0.268519196 0.267390498 0.268218111 0.26758584 0.265440019 0.267525633 0.267910441 0.268702109 0.267310708 0.265408875 0.26899355 0.265928861 0.267660314 0.268693218 0.270732499 0.270098894 0.268633421 0.267459254 0.272486693 0.266434799 0.268906407 0.275625228 0.270790444 0.266929986 0.268088498 0.268248948 0.271056937 0.271750293 0.267029296 0.268617924 0.266158729 0.273147759 0.267637392 0.266611012 0.272207122 0.271813368 0.268288177 0.267121979 0.273707021 0.266172861 0.299607534 0.266605866 0.28374445 0.268168362 0.267713145 0.268590492 0.276780408 0.269069125 0.26903476 0.269662452 0.267662144 0.269104879 0.268816536 0.267681293 0.268122522 0.274071874 0.264500299 0.268137342 0.267745738 0.266113476 0.2666407 0.269139356 0.267412399 0.266150975 0.273540053 0.268972315 0.269680302 0.267204378 0.269757117 0.268582783 0.264673464 0.267318335 0.273510937 0.266080959 0.266305531 0.268575285 0.268826839 0.265177724 0.270913144 0.26784358 0.267233207 0.267641833 0.268421832 0.265975418 0.267500671 0.297551175 0.26497317 0.270357716 0.271269818 0.315794075 0.26803337 0.300094805 0.267820974 0.280328402 0.264058459 0.266002944 0.268041587 0.26901659 0.300562164 0.266554995 0.264712347 0.267903745 0.267082124 0.273309791 0.278489891 0.267941512 0.272881397 0.268191963 0.271695283 0.277337373 0.268064626 0.271753873 0.267808418 0.269199565 0.270028672 0.26838903 0.269898499 0.26701274 0.268972928 0.270985628 0.269489178 0.264395044 0.270833584 0.267866434 0.266734864 0.267235603 0.267192984 0.267323938 0.267096564 0.268459804 0.268132063 0.267035359 0.267909505 0.268038493 0.267305788 0.267445018 0.266824463 0.266877075 0.269053588 0.271261121 0.272822265 0.266887519 0.26805811 0.269606501 0.269124026 0.268711485 0.266302443 0.266661806 0.267602079 0.266856367 0.270466486 0.269752616 0.270016534 0.266232461 0.266560648 0.267678859 0.267485206 0.270492359 0.266901431 0.272207302 0.267141808 0.2682982 0.265473885 0.266565701 0.266533232 0.268168063 0.268029761 0.272333867 0.286943492 0.271399087 0.267068584 0.266856189 0.267078845 0.26656579 0.268026358 0.267282587 0.268130667 0.267068248 0.267048597 0.272035674 0.266862732 0.270120529 0.268695591 0.266188081 0.270359912 0.269809037 0.267783823 0.269034769 0.267393882 0.267003297 0.266311035 0.268107031 0.269694281 0.266684703 0.267358908 0.268716804 0.268340807 0.267977346 0.268272931 0.266206673 0.268457509 0.26659858 0.272319252 0.268282528 0.268021797 0.269343882 0.266392293 0.267989748 0.27087779 0.267459648 0.269175824 0.267072611 0.266695628 0.26659418 0.270269959 0.265289913 0.275957309 0.273480536 0.266022108 0.267217311 0.26797428 0.268175561 0.268369456 0.266580308 0.268744272 0.269685034 0.267953599 0.268907221 0.267369321 0.268525614 0.268284607 0.26619634 0.26720028 0.26638297 0.2657595 0.268055786 0.267820573 0.267714631 0.2703597 0.264691072 0.269226515 0.265695758 0.272981234 0.268030073 0.267218332 0.269393813 0.267939317 0.267759522 0.268574214 0.265994165 0.270788344 0.270614338 0.266234431 0.267486204 0.267176142 0.266876653 0.268393512 0.266889665 0.269948183 0.266253498 0.266132781 0.271350382 0.268522867 0.266980189 0.266992347 0.270489141 0.269018823 0.267456627 0.26974797 0.267310838 0.267293904 0.267306901 0.266310547 0.267845182 0.271957801 0.267292639 0.268796187 0.277334899 0.264626744 0.268616104 0.268541122 0.268951535 0.266926529 0.266270054 0.267927071 0.266189912 0.266722193 0.268884431 0.267951898 0.267025875 0.266769115 0.267380373 0.266704763 0.266703448 0.267623263 0.268392072 0.268004427 0.266930262 0.2679398 0.268871351 0.273397016 0.268548476 0.268723628 0.268094045 0.268877233 0.26735512 0.271758616 0.266276549 0.269476916 0.267995889 0.268304409 0.267852423 0.267318588 0.267393164 0.269645499 0.267804099 0.270235792 0.268097158 0.269924601 0.268404371 0.267291009 0.268640009 0.270430791 0.268038085 0.267945415 0.267816792 0.268929903 0.268449292 0.270557431 0.26732128 0.266003479 0.267426772 0.273058792 0.270158533 0.27600666 0.277391477 0.268091409 0.268283601 0.278447688 0.278479503 0.269922671 0.268569761 0.267035319 0.26811589 0.268128801 0.268255797 0.268443128 0.268637748 0.269340199 0.268967796 0.26943267 0.267520502 0.27173322 0.268509134 0.265873807 0.263580772 0.264023679];
[mu,s] = normfit(ts);

conf = 3.3;
bottomXLim = mu-conf*s;
topXLim = mu+conf*s;

x = [bottomXLim:0.1:topXLim];
norm = normpdf(x, mu, s);

zval = 1.6448;
confint = zval*s + mu;

specialx = [[bottomXLim:0.1:confint] confint];
specialnorm = normpdf(specialx, mu, s);

figure;
p = plot(x, norm);
colour = get(p,'Color');
hold on;
a = area(specialx, specialnorm);
a.FaceAlpha = 0.2;
a.FaceColor = colour;
plot([mu mu], [0 max(norm)], 'Color', 'k');
% plot([confint confint], [0 normpdf(confint,mu,s)], 'Color', colour);
box off;
set(gca, 'YTick', []);
set(gca,'YColor','white');
xlim([bottomXLim topXLim]);
xlabel('Authentication time / ms');
xticks([mu-3*s:s:mu+3*s]);

text(confint, normpdf(confint, mu, s), 'Bla');
set(gca,'xticklabel',num2str(get(gca,'xtick')','%.1f'))